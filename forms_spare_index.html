
<script>
  function doPost(e) {
  try {
    // –£–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–∞, –∫—É–¥–∞ –±—É–¥—É—Ç –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –¥–∞–Ω–Ω—ã–µ
    var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("–õ–∏—Å—Ç1");
    if (!sheet) throw new Error("–õ–∏—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω!");

    // –ü–∞—Ä—Å–∏–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞
    var data = JSON.parse(e.postData.contents);

    // –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä–æ–∫—É —Å –¥–∞–Ω–Ω—ã–º–∏
    var row = [
      "",                          // –ü—É—Å—Ç–∞—è —è—á–µ–π–∫–∞ –¥–ª—è –Ω—É–º–µ—Ä–∞—Ü–∏–∏, –æ–Ω–∞ –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ
      data.name || "",             // –ò–º—è
      data.secondName || "",       // –§–∞–º–∏–ª–∏—è
      data.phone || "",            // –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞
      data.city || "",             // –ì–æ—Ä–æ–¥
      data.church || "",           // –ù–∞–∑–≤–∞–Ω–∏–µ —Ü–µ—Ä–∫–≤–∏
      data.pastorName || "",       // –§–ò–û –ø–∞—Å—Ç–æ—Ä–∞
      data.ministry || "",         // –°–ª—É–∂–µ–Ω–∏–µ
      data.arrivalDate || "",      // –î–µ–Ω—å –ø—Ä–∏–µ–∑–¥–∞
      data.departureDate || "",    // –î–µ–Ω—å –æ—Ç—ä–µ–∑–¥–∞
      ""                           // –ü—É—Å—Ç–∞—è —è—á–µ–π–∫–∞ –¥–ª—è –¥–∞—Ç—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, –æ–Ω–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ
    ];

    // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–æ–∫—É –≤ —Ç–∞–±–ª–∏—Ü—É
    var newRowIndex = sheet.appendRow(row).getLastRow();

    // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è
    var currentDateTime = new Date();
    var formattedDateTime = Utilities.formatDate(currentDateTime, Session.getScriptTimeZone(), "dd/MM/yyyy HH:mm:ss");

    // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è –≤ —Å—Ç–æ–ª–±–µ—Ü "–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏" (–ø–æ—Å–ª–µ–¥–Ω–∏–π —Å—Ç–æ–ª–±–µ—Ü)
    sheet.getRange(newRowIndex, row.length).setValue(formattedDateTime);

    // –û–±–Ω–æ–≤–ª—è–µ–º –Ω—É–º–µ—Ä–∞—Ü–∏—é (—Å—Ç–æ–ª–±–µ—Ü A)
    updateRowNumbers(sheet);

    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç
    return ContentService.createTextOutput("–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Ç–∞–±–ª–∏—Ü—É.")
      .setMimeType(ContentService.MimeType.TEXT);
  } catch (error) {
    // –õ–æ–≥–∏—Ä—É–µ–º –æ—à–∏–±–∫—É –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –æ—Ç–≤–µ—Ç —Å –æ—à–∏–±–∫–æ–π
    Logger.log(error);
    return ContentService.createTextOutput("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: " + error.message)
      .setMimeType(ContentService.MimeType.TEXT);
  }
}

function updateRowNumbers(sheet) {
  const startRow = 2; // –ù–∞—á–∏–Ω–∞–µ–º —Å 2-–π —Å—Ç—Ä–æ–∫–∏ (–ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ - –∑–∞–≥–æ–ª–æ–≤–∫–∏)
  const lastRow = sheet.getLastRow(); // –ü–æ–ª—É—á–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –∏–Ω–¥–µ–∫—Å —Å—Ç—Ä–æ–∫–∏
  const numRange = sheet.getRange(startRow, 1, lastRow - startRow + 1, 1); // –î–∏–∞–ø–∞–∑–æ–Ω –¥–ª—è –Ω—É–º–µ—Ä–∞—Ü–∏–∏
  const numValues = [];

  // –ó–∞–ø–æ–ª–Ω—è–µ–º –Ω—É–º–µ—Ä–∞—Ü–∏—é –¥–ª—è —Å—Ç–æ–ª–±—Ü–∞ A
  for (let i = 0; i < lastRow - startRow + 1; i++) {
    numValues.push([i + 1]); // –ó–∞–ø–æ–ª–Ω—è–µ–º –º–∞—Å—Å–∏–≤ –Ω–æ–º–µ—Ä–∞–º–∏
  }

  // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å—Ç–æ–ª–±–µ—Ü A
  numRange.setValues(numValues);
}


</script>



<script>
  document.getElementById('registrationForm').addEventListener('submit', function (event) {
    event.preventDefault(); // –û—Ç–º–µ–Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è —Ñ–æ—Ä–º—ã

    // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–æ—Ä–º—ã
    const formData = {
        name: document.getElementById('sendName_mission_conference').value,
        secondName: document.getElementById('sendSecondName_mission_conference').value,
        
        // –û—á–∏—â–∞–µ–º –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –æ—Ç –≤—Å–µ—Ö —Å–∏–º–≤–æ–ª–æ–≤, –∫—Ä–æ–º–µ —Ü–∏—Ñ—Ä
        phone: document.getElementById('sendTel_mission_conference').value.replace(/\D/g, ''), // –£–±–∏—Ä–∞–µ–º –≤—Å–µ –Ω–µ—Ü–∏—Ñ—Ä–æ–≤—ã–µ —Å–∏–º–≤–æ–ª—ã
        
        // –ù–æ–≤—ã–µ –ø–æ–ª—è
        city: document.getElementById('sendCity_mission_conference').value,
        church: document.getElementById('sendChurch_mission_conference').value,
        pastorName: document.getElementById('sendPastorName_mission_conference').value,
        ministry: document.getElementById('sendMinistry_mission_conference').value,
        arrivalDate: document.getElementById('arrivalDate_mission_conference').value,
        departureDate: document.getElementById('departureDate_mission_conference').value
    };

    // URL –≤–∞—à–µ–≥–æ Google Apps Script
    const scriptURL = 'https://script.google.com/macros/s/AKfycbw3cELx4iweiZVBoVQz1oLroucgeqxBwB-Aade7NA9r7cuXKerU4hPDsG0hZ6AWfSsrPQ/exec';

    // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    fetch(scriptURL, {
        method: 'POST',
        body: JSON.stringify(formData)
    })
    .then(response => response.text())
    .then(data => {
        alert('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ! ‚úÖ');
        document.getElementById('registrationForm').reset(); // –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã
    })
    .catch(error => {
        console.error('–û—à–∏–±–∫–∞:', error);
        alert('–°–ª–∞–±–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º ‚ö†Ô∏èüì∂. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ ‚è≥üîÑ');
    });
  });
</script>







<!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ popup -->
<div class="popup__bg_mission_conference">
  <form action="#" class="popup_mission_conference scrollable-form" id="registrationForm" name="submit-to-google-sheet">
    <h4 style="color: white;">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è <br>–Ω–∞ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—é üìã</h4>
    <br>
    <img src="img/close.svg" class="close-popup_mission_conference">
    
<label>
  <input id="sendName_mission_conference" type="text" name="name" required>
  <div class="label__text">–í–∞—à–µ –∏–º—è</div>
</label>

<label>
  <input id="sendSecondName_mission_conference" type="text" name="second-name" required>
  <div class="label__text">–í–∞—à–∞ —Ñ–∞–º–∏–ª–∏—è</div>
</label>

<label>
  <input id="sendTel_mission_conference" type="tel" name="phone" class="form-input" required>
  <div class="label__text">–í–∞—à —Ç–µ–ª–µ—Ñ–æ–Ω</div>
</label>

<label>
  <input id="sendCity_mission_conference" type="text" name="city" required>
  <div class="label__text">–ò–∑ –∫–∞–∫–æ–≥–æ –≤—ã –≥–æ—Ä–æ–¥–∞</div>
</label>

<label>
  <input id="sendChurch_mission_conference" type="text" name="church" required>
  <div class="label__text">–ù–∞–∑–≤–∞–Ω–∏–µ –≤–∞—à–µ–π —Ü–µ—Ä–∫–≤–∏</div>
</label>

<label>
  <input id="sendPastorName_mission_conference" type="text" name="pastor-name" required>
  <div class="label__text">–§–ò–û –ø–∞—Å—Ç–æ—Ä–∞ –≤–∞—à–µ–π —Ü–µ—Ä–∫–≤–∏</div>
</label>

<label>
  <input id="sendMinistry_mission_conference" type="text" name="ministry" required>
  <div class="label__text">–í–∞—à–µ —Å–ª—É–∂–µ–Ω–∏–µ –≤ —Ü–µ—Ä–∫–≤–∏</div>
</label>

<label class="date-container">
  <input id="arrivalDate_mission_conference" type="date" name="arrival-date" max="2025-12-31" value="2025-05-08" required>
  <span class="calendar-icon" onclick="document.getElementById('arrivalDate_mission_conference').showPicker()"><img class="calendar-icon" src="img/calendar.svg"></span>
  <div class="label__text">–î–µ–Ω—å –ø—Ä–∏–µ–∑–¥–∞</div>
</label>

<label class="date-container">
  <input id="departureDate_mission_conference" type="date" name="departure-date" max="2025-12-31" value="2025-05-10" required>
  <span class="calendar-icon" onclick="document.getElementById('departureDate_mission_conference').showPicker()"><img class="calendar-icon" src="img/calendar.svg"></span>
  <div class="label__text">–î–µ–Ω—å –æ—Ç—ä–µ–∑–¥–∞</div>
</label>

    
 <div class="payment_info" style="color: white; font-size: 14px; line-height: 1.5;">
  –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ–π —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —á–µ–∫–∞ üìÑ.<br><br>
  –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –æ–ø–ª–∞—Ç—ã –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —á–µ–∫–∞, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç—É —Ñ–æ—Ä–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É <b>‚Äú–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è‚Äù</b> üìã‚úîÔ∏è. <br>–≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –Ω–∞–º –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –≤–∞—à—É –∑–∞—è–≤–∫—É –∑–∞—Ä–∞–Ω–µ–µ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –≤—Å—ë –¥–ª—è –≤–∞—à–µ–≥–æ —É—á–∞—Å—Ç–∏—è. üôå‚ú®<br><br>
  
  –ß—Ç–æ–±—ã –∑–∞–≤–µ—Ä—à–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é: <br>
  1Ô∏è‚É£ <b>–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç—É —Ñ–æ—Ä–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é</b> üìù –∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É <b>‚Äú–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è‚Äù</b>.  
  –≠—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è –≤–∞—à–µ–≥–æ —É—á–∞—Å—Ç–∏—è.<br><br>
  
  2Ô∏è‚É£ <b>–û–ø–ª–∞—Ç–∏—Ç–µ —É—á–∞—Å—Ç–∏–µ –≤ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏</b> üí≥.<br>
  –°–¥–µ–ª–∞—Ç—å —ç—Ç–æ –º–æ–∂–Ω–æ, –ø–µ—Ä–µ–π–¥—è –ø–æ —Å—Å—ã–ª–∫–µ:<br>
  <a href="buy-ticket.html" target="_blank" style="text-decoration: underline; font-weight: bold;">–û–ü–õ–ê–¢–ê (–æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ)</a>.<br><br>
  
  3Ô∏è‚É£ <b>–ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –∑–∞–≥—Ä—É–∑–∏—Ç–µ —á–µ–∫</b> üì§.<br>
  –ß–µ–∫ –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ:<br>
  <a href="buy-ticket.html" target="_blank" style="text-decoration: underline; font-weight: bold;">–û–ü–õ–ê–¢–ê (–æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ)</a>.<br><br>
  
  <small>–ü–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –≤—ã —Å–æ–≤–µ—Ä—à–∏–ª–∏ –æ–ø–ª–∞—Ç—É –∏ –∑–∞–≥—Ä—É–∑–∏–ª–∏ —á–µ–∫, –ø–æ–≤—Ç–æ—Ä–Ω–æ –∑–∞–ø–æ–ª–Ω—è—Ç—å –¥–∞–Ω–Ω—É—é —Ñ–æ—Ä–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–µ –Ω—É–∂–Ω–æ! ‚úÖ</small><br><br>
  
  –û—Ç–ø—Ä–∞–≤–∏—Ç—å —á–µ–∫ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ <b>25 –∞–ø—Ä–µ–ª—è 2025 –≥–æ–¥–∞</b> ‚è≥.<br><br>
  
  –°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∏ –≤–Ω–∏–º–∞–Ω–∏–µ –∫ –¥–µ—Ç–∞–ª—è–º! –ú—ã —Å –Ω–µ—Ç–µ—Ä–ø–µ–Ω–∏–µ–º –∂–¥—ë–º –≤–∞—Å –Ω–∞ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏! üôå‚ú®
</div>

    <div class="privacy_policy">
      –ù–∞–∂–∏–º–∞—è –Ω–∞ –∫–Ω–æ–ø–∫—É "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è", –≤—ã –¥–∞–µ—Ç–µ —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ–≥–ª–∞—à–∞–µ—Ç–µ—Å—å —Å
      <a href="privacy.html" target="_blank"><u>–ø–æ–ª–∏—Ç–∏–∫–æ–π –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</u></a>.
    </div>
    
    <button type="submit" id="sendButton_mission_conference" class="about-btn close_through_submit_mission_conference">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
  </form>
</div>






=============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================

























